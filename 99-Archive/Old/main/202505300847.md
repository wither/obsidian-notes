# Path Traversal - Prevention

The most effective way to prevent path traversal vulnerabilities is to avoid passing user-supplied input to filesystem APIs altogether. 

If you can't avoid passing user-supplied input to filesystem APIs, we recommend using two layers of defence to prevent attacks:

- Validate the user input before processing it. 
	- Ideally, compare the user input with a whitelist of permitted values. If that isn't possible, verify that the input contains only permitted content, such as alphanumeric characters only.
- After validating the supplied input, append the input to the base directory and use a platform filesystem API to canonicalize the path. The canonical path is cleansed, simplified, case-normalized, and complete, and all symbolic links have been followed. Verify that the canonicalized path starts with the expected base directory

---

## Related:
- [[202505300848|Path Traversal - Quick Reference]]

## References
- https://portswigger.net/web-security/learning-paths/path-traversal/